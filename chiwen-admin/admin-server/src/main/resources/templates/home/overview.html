<div class="app-main">
  <div class="header_top clearfix">
    <p class="information">
      今日访问：<span class="todayVisit">${homeVo.todayAccess}</span>
      IP总访问：<span class="IPVisit">${homeVo.ipTotalAccess}</span>
      今日违规：<span class="todayIllegal">${homeVo.todayViolation}</span>
      违规次数：<span class="IllegalNum">${homeVo.totalViolation}</span>
    </p>
    <div class="function clearfix">
      <div class="safety" title="安全指数"><img src="/img/safety.png" style="margin-top: 10px;"></div>
      <div class="Time">
        <span>${homeVo.highDay}</span><span>${homeVo.day}</span>天<span>${homeVo.highhour}</span><span>${homeVo.hour}</span>时
      </div>
      <div class="dropdown colony js-firstColum">
        <button class="btn" type="button" id="dropdownMenu1" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="true">
          HAVE01<i class="glyphicon glyphicon-menu-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
          <li><a href="javascript:;" data-id="1">HAVE01</a></li>
          <li><a href="javascript:;" data-id="2">HAVE02</a></li>
          <li><a href="javascript:;" data-id="3">HAVE03</a></li>
          <li><a href="javascript:;" data-id="4">HAVE04</a></li>
        </ul>
        <span class="btn btn-search">添加集群</span>
      </div>
    </div>
  </div>
  <div class="colonyBox">
    <ul class="clearfix">
      [#list homeVo.pluginStatusVos as plugin]
      <li>
        <div class="business">
          [#if plugin.type == "hdfs"]
          <p>HFDS</p>
          [/#if]
          [#if plugin.type == "hbase"]
          <p>HBASE</p>
          [/#if]
          <div class="business_cont">
            <ul class="clearfix">
              <li>
                <p>用户</p>
                <span>${plugin.userCount}</span>
              </li>
              <li>
                <p>权限</p>
                <span>${plugin.authCount}</span>
              </li>
              <li>
                <p>审计</p>
                <span>${plugin.auditCount}</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="operation panel-heading">
          [#if plugin.status == "0"]
          <a href="#">运行中<i class="glyphicon glyphicon-menu-right"></i></a>
          [/#if]
          [#if plugin.type == "1"]
          <a href="#" class="notice">异常<i class="glyphicon glyphicon-menu-right"></i></a>
          [/#if]
        </div>
      </li>
      [/#list]

      <!--<li>
        <div class="business">
          <p>HFDS</p>
          <div class="business_cont">
            <ul class="clearfix">
              <li>
                <p>用户</p>
                <span>239</span>
              </li>
              <li>
                <p>权限</p>
                <span>39</span>
              </li>
              <li>
                <p>审计</p>
                <span>4,509</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="operation panel-heading">
          <a href="#" class="notice">异常<i class="glyphicon glyphicon-menu-right"></i></a>
        </div>
      </li>
      <li>
        <div class="business">
          <p>HFDS</p>
          <div class="business_cont">
            <ul class="clearfix">
              <li>
                <p>用户</p>
                <span class="fontColor">239</span>
              </li>
              <li>
                <p>权限</p>
                <span>39</span>
              </li>
              <li>
                <p>审计</p>
                <span>4,509</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="operation panel-heading">
          <a href="#" class="notice">异常<i class="glyphicon glyphicon-menu-right"></i></a>
        </div>
      </li>
      <li>
        <div class="business">
          <p>HFDS</p>
          <div class="business_cont">
            <ul class="clearfix">
              <li>
                <p>用户</p>
                <span>239</span>
              </li>
              <li>
                <p>权限</p>
                <span>39</span>
              </li>
              <li>
                <p>审计</p>
                <span>4,509</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="operation panel-heading">
          <a href="#" class="notice">异常<i class="glyphicon glyphicon-menu-right"></i></a>
        </div>
      </li>-->
    </ul>
  </div>
  <div class="statisticsNav">
    <div class="statisticsHeader clearfix">
      <p class="statisticsTitle">访问统计</p>
      <div class="strightNav">
        <ul class="clearfix js-strightNav">
          <li><a href="javascript:;" data-type="1" class="active">2小时</a></li>
          <li><a href="javascript:;" data-type="2">今日</a></li>
          <li><a href="javascript:;" data-type="3">本周</a></li>
          <li><a href="javascript:;" data-type="4">本月</a></li>
          <li><input size="16" placeholder="选择开始时间" type="text" id="datetimeStart" readonly
                     class="form_datetime"></li>
          <li><input size="16" placeholder="选择结束时间" type="text" id="datetimeEnd" readonly
                     class="form_datetime"></li>
          <li><span class="btn btn-search js-sub">查询</span></li>
        </ul>
      </div>
    </div>
    <div class="echartsBox clearfix ">
      <div class="echartsblock panel panel-default">
        <p class="panel-heading"><span>访问统计</span><a href="#">更多...</a></p>
        <div id="visitStatistic" class="echartsModel"></div>
      </div>
      <div class="echartsblock  panel panel-default">
        <p class="panel-heading"><span>组件风险</span><a href="#">更多...</a></p>
        <div id="riskStatistic" class="echartsModel"></div>
      </div>
      <div class="echartsblock  panel panel-default">
        <p class="panel-heading"><span>访问类型</span><a href="#">更多...</a></p>
        <div id="visitType" class="echartsModel"></div>
      </div>
    </div>
  </div>
</div>
<!-- bootstrap3 -->
<script src="/lib/echarts.min.js"></script>
<!-- 倒计时控件 -->
<script src="/lib/jquery.downCount.js"></script>
<script type="text/javascript">

  loadDate('month',null,null);

  $(function(){
    // 关闭菜单
    $(document).on("click", function(){
      $(window.parent.document).find('.onemenu').slideUp();
      $(window.parent.document).find('.dropMenu li > a').siblings('ul').find('li').eq(0).find('ul').show();
    });
    //注意：下面的代码是放在iframe引用的子页面中调用
    $(window.parent.document).find("#mainframe").load(function () {
      var main = $(window.parent.document).find("#mainframe");
      var thisheight = $(document).height() + 30;
      main.height(thisheight);
    });
    // 仪表盘 ---- 开始
    // 仪表盘 ----结束
    // 时间插件---开始
    $("#datetimeStart").datetimepicker({
      format: 'yyyy-mm-dd',
      minView:'month',
      language: 'zh-CN',
      autoclose:true,
      startDate:new Date()
    }).on("click",function(){
      $("#datetimeStart").datetimepicker("setEndDate",$("#datetimeEnd").val());
    });
    $("#datetimeEnd").datetimepicker({
      format: 'yyyy-mm-dd',
      minView:'month',
      language: 'zh-CN',
      autoclose:true,
      startDate:new Date()
    }).on("click",function(){
      $("#datetimeEnd").datetimepicker("setStartDate",$("#datetimeStart").val());
    });
    // 时间插件 ----结束
    // 访问统计---开始
    var myVisitStatistic = echarts.init(document.getElementById('visitStatistic'));
    // 指定图表的配置项和数据
    var VisitStatistic = {
      tooltip : {
        trigger: 'axis',
        axisPointer: {
          type: 'cross'
        }
      },
      legend: {
        show:true,
        top:10,
        right:10,
        data:[{
          name: 'HBACE',
          icon: 'pin'
        },{
          name: 'HIVE',
          icon: 'pin'
        },{
          name: 'HFDS',
          icon: 'pin'
        }]
      },
      grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
      },
      xAxis : [
        {
          type : 'category',
          boundaryGap : false,
          data : ['7月1日','7月2日','7月3日','7月4日','7月5日','7月6日','7月7日']
        }
      ],
      yAxis : [
        {
          type : 'value'
        }
      ],
      series : [
        {
          name:'HBACE',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#697afa',
              lineStyle:{
                color:'#697afa'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#697afa' // 0% 处的颜色
                }, {
                  offset: 1, color: '#697afa' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[120, 132, 101, 134, 90, 230, 210]
        },{
          name:'HIVE',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#f3bd47',
              lineStyle:{
                color:'#f3bd47'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#f3bd47' // 0% 处的颜色
                }, {
                  offset: 1, color: '#f3bd47' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[220, 182, 191, 234, 290, 330, 310]
        },{
          name:'HFDS',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#06c6a0',
              lineStyle:{
                color:'#06c6a0'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#06c6a0' // 0% 处的颜色
                }, {
                  offset: 1, color: '#06c6a0' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[220, 182, 191, 234, 290, 330, 310]
        }
      ]
    };
    // 使用刚指定的配置项和数据显示图表。
    myVisitStatistic.setOption(VisitStatistic);

    // 组件风险---开始
    var myriskStatistic = echarts.init(document.getElementById('riskStatistic'));
    // 指定图表的配置项和数据
    var RiskStatistic = {
      tooltip : {
        trigger: 'axis',
        axisPointer: {
          type: 'cross'
        }
      },
      legend: {
        show:true,
        top:10,
        right:10,
        data:[{
          name: 'HBACE',
          icon: 'pin'
        },{
          name: 'HIVE',
          icon: 'pin'
        },{
          name: 'HFDS',
          icon: 'pin'
        }]
      },
      grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
      },
      xAxis : [
        {
          type : 'category',
          boundaryGap : false,
          data : ['7月1日','7月2日','7月3日','7月4日','7月5日','7月6日','7月7日']
        }
      ],
      yAxis : [
        {
          type : 'value'
        }
      ],
      series : [
        {
          name:'HBACE',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#697afa',
              lineStyle:{
                color:'#697afa'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#697afa' // 0% 处的颜色
                }, {
                  offset: 1, color: '#697afa' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[120, 132, 101, 134, 90, 230, 210]
        },{
          name:'HIVE',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#f3bd47',
              lineStyle:{
                color:'#f3bd47'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#f3bd47' // 0% 处的颜色
                }, {
                  offset: 1, color: '#f3bd47' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[220, 182, 191, 234, 290, 330, 310]
        },{
          name:'HFDS',
          type:'line',
          stack: '总量',
          smooth:true,
          itemStyle : {
            normal : {
              color:'#06c6a0',
              lineStyle:{
                color:'#06c6a0'
              }
            }
          },
          areaStyle: {
            normal: {
              color:{
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0.5, color: '#06c6a0' // 0% 处的颜色
                }, {
                  offset: 1, color: '#06c6a0' // 100% 处的颜色
                }],
                globalCoord: false // 缺省为 false
              }
            }
          },
          data:[220, 182, 191, 234, 290, 330, 310]
        }
      ]
    };
    // 使用刚指定的配置项和数据显示图表。
    myriskStatistic.setOption(RiskStatistic);

    // 访问类型---开始
    var myvisitType = echarts.init(document.getElementById('visitType'));
    // 指定图表的配置项和数据
    var VisitType = {
      tooltip : {
        trigger: 'item',
        formatter: "{a} <br/>{b} : {c} ({d}%)"
      },
      /*legend: {
       orient: 'vertical',
       top:20,
       right:'15',
       data: ['文件列表','创建文件夹','其他']
       },*/
      color:['#697afa', '#06c6a0','#f3bd47'],
      series : [
        {
          name: '访问类型',
          type: 'pie',
          radius: ['50%', '70%'],
          center: ['50%', '50%'],
          data:[{
            value:300,name:'文件列表',
          },{
            value:100, name:'创建文件夹'
          },{
            value:150, name:'其他'}
          ],
          itemStyle: {
            emphasis: {
              shadowBlur: 10,
              shadowOffsetX: 0,
              shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
          }
        }
      ]
    };
    // 使用刚指定的配置项和数据显示图表。
    myvisitType.setOption(VisitType);
    /*窗口自适应，关键代码*/
    $(window).resize(function(){
      myVisitStatistic.resize();
      myriskStatistic.resize();
      myvisitType.resize();
    });
    // 添加集群下拉菜单更新
    var firstColumId="";
    $('.js-firstColum li > a').click(function() {
      firstColumId = $(this).data('id');
      $('.js-firstColum > button').html($(this).text()+'<i class="glyphicon glyphicon-menu-down"></i>');
      $('.js-firstColum > button').data('id',firstColumId);
    });
    // 点击切换 --统计访问右侧菜单
    $(document).on('click','.js-strightNav a',function(){
      $(this).addClass('active').parents('li').siblings('li').find('a').removeClass('active');
    });
    // 统计访问右侧查询交互
    $(document).on('click','.js-sub',function(){
      // 获取选中条件
      var statType = $(this).parents('li').siblings('li').find('a.active').data('type');
      // 开始时间
      var startTime = $('#datetimeStart').val();
      // 结束时间
      var endTime = $('#datetimeEnd').val();
      // console.log(statType,startTime,endTime)
      var params = {
        statType: statType,
        startTime:startTime,
        endTime:endTime
      };
      var post = $.post('/', params);
      post.done(function(data) {
        console.log(data)
      });
    });
  });

  function loadDate(auditDateType,startTime,endTime) {
    var url = '/home/query?&auditDateType=' + auditDateType + '&startTime=' + startTime + '&endTime=' + endTime ;
    $.ajax({
      type: 'GET',
      url: url,
      dataType: 'json',
      success: function (data) {
        console.log(data);


      },
    });
  }

</script>
